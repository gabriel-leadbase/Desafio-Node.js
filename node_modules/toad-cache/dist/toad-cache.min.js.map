{"version":3,"file":"toad-cache.min.js","sources":["../src/FifoMap.js","../src/LruMap.js","../src/LruObject.js","../src/HitStatisticsRecord.js","../src/utils/dateUtils.js","../src/HitStatistics.js","../src/LruObjectHitStatistics.js","../src/FifoObject.js"],"sourcesContent":["export class FifoMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = new Map()\n    this.last = null\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  clear() {\n    this.items = new Map()\n    this.first = null\n    this.last = null\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const deletedItem = this.items.get(key)\n\n      this.items.delete(key)\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      this.items.delete(item.key)\n\n      if (this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items.set(key, item)\n\n    if (this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class LruMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = new Map()\n    this.last = null\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  bumpLru(item) {\n    const last = this.last\n    const next = item.next\n    const prev = item.prev\n\n    if (this.first === item) {\n      this.first = item.next\n    }\n\n    item.next = null\n    item.prev = this.last\n    last.next = item\n\n    if (prev !== null) {\n      prev.next = next\n    }\n\n    if (next !== null) {\n      next.prev = prev\n    }\n\n    this.last = item\n  }\n\n  clear() {\n    this.items = new Map()\n    this.first = null\n    this.last = null\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      this.items.delete(key)\n\n      if (item.prev !== null) {\n        item.prev.next = item.next\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev\n      }\n\n      if (this.first === item) {\n        this.first = item.next\n      }\n\n      if (this.last === item) {\n        this.last = item.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      this.items.delete(item.key)\n\n      if (this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      if (this.last !== item) {\n        this.bumpLru(item)\n      }\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items.set(key, item)\n\n    if (this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class LruObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = Object.create(null)\n    this.last = null\n    this.size = 0\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  bumpLru(item) {\n    const last = this.last\n    const next = item.next\n    const prev = item.prev\n\n    if (this.first === item) {\n      this.first = item.next\n    }\n\n    item.next = null\n    item.prev = this.last\n    last.next = item\n\n    if (prev !== null) {\n      prev.next = next\n    }\n\n    if (next !== null) {\n      next.prev = prev\n    }\n\n    this.last = item\n  }\n\n  clear() {\n    this.items = Object.create(null)\n    this.first = null\n    this.last = null\n    this.size = 0\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      delete this.items[key]\n      this.size--\n\n      if (item.prev !== null) {\n        item.prev.next = item.next\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev\n      }\n\n      if (this.first === item) {\n        this.first = item.next\n      }\n\n      if (this.last === item) {\n        this.last = item.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      delete this.items[item.key]\n\n      if (--this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      if (this.last !== item) {\n        this.bumpLru(item)\n      }\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items[key] = item\n\n    if (++this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class HitStatisticsRecord {\n  constructor() {\n    this.records = {}\n  }\n\n  initForCache(cacheId, currentTimeStamp) {\n    this.records[cacheId] = {\n      [currentTimeStamp]: {\n        hits: 0,\n        misses: 0,\n        expirations: 0,\n      },\n    }\n  }\n\n  resetForCache(cacheId) {\n    for (let key of Object.keys(this.records[cacheId])) {\n      this.records[cacheId][key] = {\n        hits: 0,\n        misses: 0,\n        expirations: 0,\n      }\n    }\n  }\n\n  getStatistics() {\n    return this.records\n  }\n}\n","/**\n *\n * @param {Date} date\n * @returns {string}\n */\nexport function getTimestamp(date) {\n  return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date\n    .getDate()\n    .toString()\n    .padStart(2, '0')}`\n}\n","import { HitStatisticsRecord } from './HitStatisticsRecord.js'\nimport { getTimestamp } from './utils/dateUtils.js'\n\nexport class HitStatistics {\n  constructor(cacheId, statisticTtlInHours, globalStatisticsRecord) {\n    this.collectionStart = new Date()\n\n    this.lastTimeStamp = ''\n    this.currentTimeStamp = getTimestamp(this.collectionStart)\n    this.cacheId = cacheId\n    this.statisticTtlInHours = statisticTtlInHours\n\n    this.records = globalStatisticsRecord || new HitStatisticsRecord()\n    this.records.initForCache(this.cacheId, this.currentTimeStamp)\n  }\n\n  hoursPassed() {\n    return (Date.now() - this.collectionStart) / 1000 / 60 / 60\n  }\n\n  addHit() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].hits++\n  }\n\n  addMiss() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].misses++\n  }\n\n  addExpiration() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].expirations++\n  }\n\n  getStatistics() {\n    return this.records.getStatistics()\n  }\n\n  archiveIfNeeded() {\n    if (this.hoursPassed() >= this.statisticTtlInHours) {\n      const now = new Date()\n      const newTimestamp = getTimestamp(now)\n\n      if (this.lastTimeStamp && this.lastTimeStamp !== newTimestamp) {\n        delete this.records.records[this.cacheId][this.lastTimeStamp]\n      }\n      this.lastTimeStamp = this.currentTimeStamp\n\n      this.collectionStart = now\n      this.currentTimeStamp = getTimestamp(this.collectionStart)\n      this.records.initForCache(this.cacheId, this.currentTimeStamp)\n    }\n  }\n}\n","import { LruObject } from './LruObject.js'\nimport { HitStatistics } from './HitStatistics.js'\n\nexport class LruObjectHitStatistics extends LruObject {\n  constructor(max, ttlInMsecs, cacheId, globalStatisticsRecord, statisticTtlInHours) {\n    super(max || 1000, ttlInMsecs || 0)\n\n    if (!cacheId) {\n      throw new Error('Cache id is mandatory')\n    }\n\n    this.hitStatistics = new HitStatistics(\n      cacheId,\n      statisticTtlInHours !== undefined ? statisticTtlInHours : 24,\n      globalStatisticsRecord,\n    )\n  }\n\n  getStatistics() {\n    return this.hitStatistics.getStatistics()\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        this.hitStatistics.addExpiration()\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      this.hitStatistics.addHit()\n      return item.value\n    }\n    this.hitStatistics.addMiss()\n  }\n}\n","export class FifoObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = Object.create(null)\n    this.last = null\n    this.size = 0\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  clear() {\n    this.items = Object.create(null)\n    this.first = null\n    this.last = null\n    this.size = 0\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const deletedItem = this.items[key]\n\n      delete this.items[key]\n      this.size--\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      delete this.items[item.key]\n\n      if (--this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items[key] = item\n\n    if (++this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n"],"names":["FifoMap","constructor","max","ttlInMsecs","isNaN","Error","this","first","items","Map","last","ttl","size","clear","key","has","deletedItem","get","delete","prev","next","deleteMany","keys","i","length","evict","item","expiresAt","expiry","Date","now","value","getMany","result","push","set","LruMap","bumpLru","LruObject","Object","create","prototype","hasOwnProperty","call","HitStatisticsRecord","records","initForCache","cacheId","currentTimeStamp","hits","misses","expirations","resetForCache","getStatistics","getTimestamp","date","getFullYear","getMonth","toString","padStart","getDate","HitStatistics","statisticTtlInHours","globalStatisticsRecord","collectionStart","lastTimeStamp","hoursPassed","addHit","archiveIfNeeded","addMiss","addExpiration","newTimestamp","LruObjectHitStatistics","super","hitStatistics","undefined","FifoObject"],"mappings":"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"}