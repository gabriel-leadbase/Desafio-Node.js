{"version":3,"file":"toad-cache.umd.min.js","sources":["../src/FifoMap.js","../src/LruObject.js","../src/HitStatisticsRecord.js","../src/utils/dateUtils.js","../src/HitStatistics.js","../src/LruObjectHitStatistics.js","../src/FifoObject.js","../src/LruMap.js"],"sourcesContent":["export class FifoMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = new Map()\n    this.last = null\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  clear() {\n    this.items = new Map()\n    this.first = null\n    this.last = null\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const deletedItem = this.items.get(key)\n\n      this.items.delete(key)\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      this.items.delete(item.key)\n\n      if (this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items.set(key, item)\n\n    if (this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class LruObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = Object.create(null)\n    this.last = null\n    this.size = 0\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  bumpLru(item) {\n    const last = this.last\n    const next = item.next\n    const prev = item.prev\n\n    if (this.first === item) {\n      this.first = item.next\n    }\n\n    item.next = null\n    item.prev = this.last\n    last.next = item\n\n    if (prev !== null) {\n      prev.next = next\n    }\n\n    if (next !== null) {\n      next.prev = prev\n    }\n\n    this.last = item\n  }\n\n  clear() {\n    this.items = Object.create(null)\n    this.first = null\n    this.last = null\n    this.size = 0\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      delete this.items[key]\n      this.size--\n\n      if (item.prev !== null) {\n        item.prev.next = item.next\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev\n      }\n\n      if (this.first === item) {\n        this.first = item.next\n      }\n\n      if (this.last === item) {\n        this.last = item.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      delete this.items[item.key]\n\n      if (--this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      if (this.last !== item) {\n        this.bumpLru(item)\n      }\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items[key] = item\n\n    if (++this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class HitStatisticsRecord {\n  constructor() {\n    this.records = {}\n  }\n\n  initForCache(cacheId, currentTimeStamp) {\n    this.records[cacheId] = {\n      [currentTimeStamp]: {\n        hits: 0,\n        misses: 0,\n        expirations: 0,\n      },\n    }\n  }\n\n  resetForCache(cacheId) {\n    for (let key of Object.keys(this.records[cacheId])) {\n      this.records[cacheId][key] = {\n        hits: 0,\n        misses: 0,\n        expirations: 0,\n      }\n    }\n  }\n\n  getStatistics() {\n    return this.records\n  }\n}\n","/**\n *\n * @param {Date} date\n * @returns {string}\n */\nexport function getTimestamp(date) {\n  return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date\n    .getDate()\n    .toString()\n    .padStart(2, '0')}`\n}\n","import { HitStatisticsRecord } from './HitStatisticsRecord.js'\nimport { getTimestamp } from './utils/dateUtils.js'\n\nexport class HitStatistics {\n  constructor(cacheId, statisticTtlInHours, globalStatisticsRecord) {\n    this.collectionStart = new Date()\n\n    this.lastTimeStamp = ''\n    this.currentTimeStamp = getTimestamp(this.collectionStart)\n    this.cacheId = cacheId\n    this.statisticTtlInHours = statisticTtlInHours\n\n    this.records = globalStatisticsRecord || new HitStatisticsRecord()\n    this.records.initForCache(this.cacheId, this.currentTimeStamp)\n  }\n\n  hoursPassed() {\n    return (Date.now() - this.collectionStart) / 1000 / 60 / 60\n  }\n\n  addHit() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].hits++\n  }\n\n  addMiss() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].misses++\n  }\n\n  addExpiration() {\n    this.archiveIfNeeded()\n    this.records.records[this.cacheId][this.currentTimeStamp].expirations++\n  }\n\n  getStatistics() {\n    return this.records.getStatistics()\n  }\n\n  archiveIfNeeded() {\n    if (this.hoursPassed() >= this.statisticTtlInHours) {\n      const now = new Date()\n      const newTimestamp = getTimestamp(now)\n\n      if (this.lastTimeStamp && this.lastTimeStamp !== newTimestamp) {\n        delete this.records.records[this.cacheId][this.lastTimeStamp]\n      }\n      this.lastTimeStamp = this.currentTimeStamp\n\n      this.collectionStart = now\n      this.currentTimeStamp = getTimestamp(this.collectionStart)\n      this.records.initForCache(this.cacheId, this.currentTimeStamp)\n    }\n  }\n}\n","import { LruObject } from './LruObject.js'\nimport { HitStatistics } from './HitStatistics.js'\n\nexport class LruObjectHitStatistics extends LruObject {\n  constructor(max, ttlInMsecs, cacheId, globalStatisticsRecord, statisticTtlInHours) {\n    super(max || 1000, ttlInMsecs || 0)\n\n    if (!cacheId) {\n      throw new Error('Cache id is mandatory')\n    }\n\n    this.hitStatistics = new HitStatistics(\n      cacheId,\n      statisticTtlInHours !== undefined ? statisticTtlInHours : 24,\n      globalStatisticsRecord,\n    )\n  }\n\n  getStatistics() {\n    return this.hitStatistics.getStatistics()\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        this.hitStatistics.addExpiration()\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      this.hitStatistics.addHit()\n      return item.value\n    }\n    this.hitStatistics.addMiss()\n  }\n}\n","export class FifoObject {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = Object.create(null)\n    this.last = null\n    this.size = 0\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  clear() {\n    this.items = Object.create(null)\n    this.first = null\n    this.last = null\n    this.size = 0\n  }\n\n  delete(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const deletedItem = this.items[key]\n\n      delete this.items[key]\n      this.size--\n\n      if (deletedItem.prev !== null) {\n        deletedItem.prev.next = deletedItem.next\n      }\n\n      if (deletedItem.next !== null) {\n        deletedItem.next.prev = deletedItem.prev\n      }\n\n      if (this.first === deletedItem) {\n        this.first = deletedItem.next\n      }\n\n      if (this.last === deletedItem) {\n        this.last = deletedItem.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      delete this.items[item.key]\n\n      if (--this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      return this.items[key].expiry\n    }\n  }\n\n  get(key) {\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return Object.keys(this.items)\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (Object.prototype.hasOwnProperty.call(this.items, key)) {\n      const item = this.items[key]\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items[key] = item\n\n    if (++this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n","export class LruMap {\n  constructor(max = 1000, ttlInMsecs = 0) {\n    if (isNaN(max) || max < 0) {\n      throw new Error('Invalid max value')\n    }\n\n    if (isNaN(ttlInMsecs) || ttlInMsecs < 0) {\n      throw new Error('Invalid ttl value')\n    }\n\n    this.first = null\n    this.items = new Map()\n    this.last = null\n    this.max = max\n    this.ttl = ttlInMsecs\n  }\n\n  get size() {\n    return this.items.size\n  }\n\n  bumpLru(item) {\n    const last = this.last\n    const next = item.next\n    const prev = item.prev\n\n    if (this.first === item) {\n      this.first = item.next\n    }\n\n    item.next = null\n    item.prev = this.last\n    last.next = item\n\n    if (prev !== null) {\n      prev.next = next\n    }\n\n    if (next !== null) {\n      next.prev = prev\n    }\n\n    this.last = item\n  }\n\n  clear() {\n    this.items = new Map()\n    this.first = null\n    this.last = null\n  }\n\n  delete(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      this.items.delete(key)\n\n      if (item.prev !== null) {\n        item.prev.next = item.next\n      }\n\n      if (item.next !== null) {\n        item.next.prev = item.prev\n      }\n\n      if (this.first === item) {\n        this.first = item.next\n      }\n\n      if (this.last === item) {\n        this.last = item.prev\n      }\n    }\n  }\n\n  deleteMany(keys) {\n    for (var i = 0; i < keys.length; i++) {\n      this.delete(keys[i])\n    }\n  }\n\n  evict() {\n    if (this.size > 0) {\n      const item = this.first\n\n      this.items.delete(item.key)\n\n      if (this.size === 0) {\n        this.first = null\n        this.last = null\n      } else {\n        this.first = item.next\n        this.first.prev = null\n      }\n    }\n  }\n\n  expiresAt(key) {\n    if (this.items.has(key)) {\n      return this.items.get(key).expiry\n    }\n  }\n\n  get(key) {\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n\n      // Item has already expired\n      if (this.ttl > 0 && item.expiry <= Date.now()) {\n        this.delete(key)\n        return\n      }\n\n      // Item is still fresh\n      this.bumpLru(item)\n      return item.value\n    }\n  }\n\n  getMany(keys) {\n    const result = []\n\n    for (var i = 0; i < keys.length; i++) {\n      result.push(this.get(keys[i]))\n    }\n\n    return result\n  }\n\n  keys() {\n    return this.items.keys()\n  }\n\n  set(key, value) {\n    // Replace existing item\n    if (this.items.has(key)) {\n      const item = this.items.get(key)\n      item.value = value\n\n      item.expiry = this.ttl > 0 ? Date.now() + this.ttl : this.ttl\n\n      if (this.last !== item) {\n        this.bumpLru(item)\n      }\n      return\n    }\n\n    // Add new item\n    if (this.max > 0 && this.size === this.max) {\n      this.evict()\n    }\n\n    const item = {\n      expiry: this.ttl > 0 ? Date.now() + this.ttl : this.ttl,\n      key: key,\n      prev: this.last,\n      next: null,\n      value,\n    }\n    this.items.set(key, item)\n\n    if (this.size === 1) {\n      this.first = item\n    } else {\n      this.last.next = item\n    }\n\n    this.last = item\n  }\n}\n"],"names":["g","f","exports","module","define","amd","globalThis","self","this","LruObject","constructor","max","ttlInMsecs","isNaN","Error","first","items","Object","create","last","size","ttl","bumpLru","item","next","prev","clear","key","prototype","hasOwnProperty","call","deleteMany","keys","i","length","delete","evict","expiresAt","expiry","get","Date","now","value","getMany","result","push","set","HitStatisticsRecord","records","initForCache","cacheId","currentTimeStamp","hits","misses","expirations","resetForCache","getStatistics","getTimestamp","date","getFullYear","getMonth","toString","padStart","getDate","HitStatistics","statisticTtlInHours","globalStatisticsRecord","collectionStart","lastTimeStamp","hoursPassed","addHit","archiveIfNeeded","addMiss","addExpiration","newTimestamp","LruObjectHitStatistics","super","hitStatistics","undefined","FifoObject","deletedItem","Fifo","FifoMap","Map","has","Lru","LruHitStatistics","LruMap"],"mappings":"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"}